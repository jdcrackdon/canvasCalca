<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="eng" lang="eng">
<head>
    <link rel="stylesheet" type="text/css" href="styles/main.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script src="script.js" type="text/javascript"></script>
     <!--[if lt IE 9 ]>
        <script src="js/excanvas/excanvas.compiled.js"></script>
        <script src="js/remysharp.com/html5.js"></script>
      <![endif]-->
      
    <!--<script src="scripts/polyclip.js"></script>-->

    <script type="text/javascript">
    /*var after_click = 0;
    var x1,y1,x2,y2,leftxy,rightxy,topxy,bottonxy;
    var point_init = {'x':0, 'y':0};
    var point_1 = {'x':0, 'y':0};
    var point_2 = {'x':0, 'y':0};
    var point_3 = {'x':0, 'y':0};
    var shape = [];

    function getSlope (a1,a2,b1,b2) {
        var result;
        var ua_t=(b2.x-b1.x)*(a1.y-b1.y)-(b2.y-b1.y)*(a1.x-b1.x);
        var ub_t=(a2.x-a1.x)*(a1.y-b1.y)-(a2.y-a1.y)*(a1.x-b1.x);
        var u_b=(b2.y-b1.y)*(a2.x-a1.x)-(b2.x-b1.x)*(a2.y-a1.y);
        if(u_b!=0){
            var ua=ua_t/u_b;
            var ub=ub_t/u_b;
            if(0<=ua&&ua<=1&&0<=ub&&ub<=1){*/
                /*result=new Intersection("Intersection");
                result.points.push(new Point2D(a1.x+ua*(a2.x-a1.x),a1.y+ua*(a2.y-a1.y)));*/
                //alert("Intersection");
        /*        return false;
            }else{
                //alert("No Intersection");
                return true;
            }
        }else{
            if(ua_t==0||ub_t==0){
                alert("Coincident");
            }else{
                alert("Paralelos");
            }
        }
            return result;
    }

    function function_name (argument) {
        // body...
    }

    function crop(img_id, crop_id, x, y, width, height) {
        $('#'+crop_id).html('<img id="' + crop_id + '_img" src="' +
            $('#'+img_id).attr('src') + '" style="display:none" />');

            var scale_x = $('#'+crop_id).width() / width;
            var scale_y = $('#'+crop_id).height() / height;

            $('#'+crop_id).css({
              position: 'relative',
              overflow: 'hidden' 
            });

            $('#'+crop_id + '_img').css({
              position: 'absolute',
              display: 'block',
              left: (-x * scale_x) + 'px',
              top: (-y * scale_y) + 'px',
              width: ($('#'+img_id).width() * scale_x) + 'px',
              height: ($('#'+img_id).height() * scale_y) + 'px'
        });
      }

    $(document).ready(function() {
        var canvas = document.getElementById("myCanvas");
        var context = canvas.getContext("2d");
        $('#myCanvas').bind('click', function (ev) {
            var $img = $(ev.target);

            var offset = $img.offset();
            var x = ev.clientX - offset.left;
            var y = ev.clientY - offset.top;
            if (after_click!=0){
                if (after_click==1){
                    x2 = x1;
                    y2 = y1;
                }
                $("#trace").append(x+","+y+","+leftxy+","+bottonxy+","+rightxy+","+topxy+"</br>");
                if (x>=leftxy && y<=bottonxy && x<=rightxy && y>=topxy){
                    context.beginPath();
                    context.moveTo(x2, y2);
                    context.lineTo(x1, y1);
                    context.stroke(); 
                    after_click = 0;
                    x2=0, y2=0;
                    return;
                }

                if (after_click==1){
                    point_1.x = x;
                    point_1.y = y;
                                    context.beginPath();
                context.moveTo(x2, y2);
                context.lineTo(x, y);
                context.stroke(); 
                }

                if (after_click == 2) {
                    point_2.x = x;
                    point_2.y = y;
                                    context.beginPath();
                context.moveTo(x2, y2);
                context.lineTo(x, y);
                context.stroke(); 
                }

                if (after_click==3) {
                    point_3.x = x;
                    point_3.y = y;

                    if(!getSlope(point_init,point_1,point_2,point_3)){
                        context.beginPath();
                        context.moveTo(x2, y2);
                        context.lineTo(x1, y1);
                        context.stroke(); 
                        after_click = 0;
                        x2=0, y2=0;
                    }else{
                       context.beginPath();
                context.moveTo(x2, y2);
                context.lineTo(x, y);
                context.stroke();  
                    }
                }

                x2 = x;
                y2 = y;
                $("#trace").append("x2="+x2+"y2="+y2+"</br>");
                after_click++;
            }else{
                context.fillStyle="#FF0000";
                context.fillRect(x-2,y-2,4,4);
                after_click++;
                point_init.x = x;
                point_init.y = y;
                x1= x;
                y1= y;
                leftxy= x-10, rightxy= x+10, topxy= y-10, bottonxy= y+10;
                $("#trace").append("x1="+x1+"y1="+y1+"</br>");
            }

            //alert('clicked at x: ' + x + ', y: ' + y);
        });
    });*/
    </script>
<style type="text/css">

#canvas-wrap canvas { position:absolute; top:0; left:0; z-index:10;}
#canvas-wrap #polyclip { position:absolute; top:0; left:0; z-index:8;}
#canvas-wrap #overlay { position:absolute; top:0; left:0; width:500px; height:500px;z-index:5; }
#canvas-wrap { position:relative; width:500px; height:500px; z-index:0; }
</style>
</head>
<div id="canvas-wrap">
    <canvas id="polyClip" width="500" height="500"></canvas>
    <canvas id="myCanvas" width="500" height="500"></canvas>
    <div id="overlay">
    </div>
</div>
<div id="trace">
</div>
</body>
</html>
